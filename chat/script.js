function uhaGetScript(e,t){var n=document.createElement("script");n.src=e;var r=document.getElementsByTagName("head")[0],i=!1;n.onload=n.onreadystatechange=function(){!i&&(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")&&(i=!0,t(),n.onload=n.onreadystatechange=null,r.removeChild(n))},r.appendChild(n)}function init(){(function(e){e("<link/>",{rel:"stylesheet",type:"text/css",href:uhaproto+"chat.uha.kr/style.css"}).appendTo("head"),e("<link/>",{rel:"stylesheet",type:"text/css",href:uhaproto+"cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.css"}).appendTo("head"),uhacss&&e("<link/>",{rel:"stylesheet",type:"text/css",href:uhacss}).appendTo("head"),e(document).ready(function(){function q(t){return e("<div/>").text(t).html()}function R(){o.scrollTop(o.prop("scrollHeight"))}function U(e){N=!1,setTimeout(function(){N=!0},e)}function z(e){return e<10?"0"+e:""+e}function W(e){var t=new Date(e*1e3);return[t.getFullYear(),z(t.getMonth()+1),z(t.getDate()),z(t.getHours()),z(t.getMinutes()),z(t.getSeconds())]}function J(e){return e.replace(F,'<a href="$&" target="uha_kr">$&</a>')}function K(e,t){var n='<span class="name'+((e.type=="1"?" member":"")+(e.oto==1?" oto":""))+'" style="color:#'+Z(e.sid+A)+';" data-date="'+e.date+'" data-sid="'+e.sid+'" data-name="'+q(e.name)+'">'+(e.oto&&e.sid==nt?"ë‚˜â†’":"")+q(e.name)+(e.oto&&e.sid!=nt?"â†’ë‚˜":"")+"</span>",r='<span class="text">'+J(q(e.msg))+"</span>",i='<span class="delete">ğŸ‘</span>',s="<time>"+X(e.date)+"</time>",u='<li class="'+(e.sid==nt?"is_me":"is_notme")+'">'+n+r+s+i+"</li>";t==0?(B&&(new Date(B*1e3)).getDate()!=(new Date(e.date*1e3)).getDate()&&o.append('<li class="date"><span>'+V(e.date)+"</span></li>"),o.append(u),B=e.date):(j?(new Date(j*1e3)).getDate()!=(new Date(e.date*1e3)).getDate()&&o.prepend('<li class="date"><span>'+V(j)+"</span></li>"):B=e.date,o.prepend(u),j=e.date)}function Q(){var e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t}function G(e){var t=window.crcTable||(window.crcTable=Q()),n=-1;for(var r=0;r<e.length;r++)n=n>>>8^t[(n^e.charCodeAt(r))&255];return(n^-1)>>>0}function Y(e){var t=parseInt(e).toString(16);return t.length==1?"0"+t:t}function Z(e){var t=G(e),n=t/1e6%192;n+=n%5;var r=t%1e6/1e3%192;r+=r%5;var i=t%1e3%192;return i+=i%5,O==1&&(n=Math.min(255,n+128),r=Math.min(255,r+128),i=Math.min(255,i+128)),Y(n)+Y(r)+Y(i)}var t='<div id="uha_chat">      <div id="uha_chat_top_text">        <select id="uha_chat_opacity"><option value="1.0" selected="selected">100%</option><option value="0.9">90%</option><option value="0.8">80%</option><option value="0.7">70%</option><option value="0.6">60%</option><option value="0.5">50%</option><option value="0.4">40%</option><option value="0.3">30%</option><option value="0.2">20%</option><option value="0.1">10%</option></select>        <div id="uha_chat_btnclear" class="uha_chat_link" alt="ì‹¹ì“¸ì´" title="ì‹¹ì“¸ì´"></div>        <div id="uha_chat_btnsettings" class="uha_chat_link" alt="ì •ë³´" title="ì •ë³´"></div>        ì‹¤ì‹œê°„: <span id="uha_chat_users_count">0</span>ëª…      </div>      <div id="uha_chat_info"></div>      <div id="uha_chat_contextmenu"></div>      <div id="uha_chat_settings"><input id="uha_chat_nickname" type="text" placeholder="ë°”ê¿€ ì´ë¦„"><label><input id="uha_chat_notifysound" type="checkbox">ì†Œë¦¬ ì•Œë¦¼</label><label><input id="uha_chat_notifytitle" type="checkbox">ì°½ ì œëª© ì•Œë¦¼</label><div class="clear"></div></div>      <div id="uha_chat_admin"><input id="uha_chat_adminpw" type="password" placeholder="ê´€ë¦¬ì ì•”í˜¸"><div id="uha_chat_adminstatus"></div><div id="uha_chat_adminmutelist"></div></div>      <ul id="uha_chat_msgs"></ul>      <form id="uha_chat_form" action="">        <button type="submit">ë³´ë‚´ê¸°</button>        <div><input id="uha_chat_input" autocomplete="off" type="text" minlength="1" maxlength="200" placeholder="ë“¤ì–´ê°€ëŠ” ì¤‘..."></div>      </form>      <audio id="uhatest" style="display:none" controls="" preload="none"><source src="'+uhaproto+'uha.kr/uha.mp3" type="audio/mpeg"></audio>      <!--audio: https://freesound.org/people/robni7/sounds/174027/-->      <form id="uha_popup_form" action="'+uhaproto+"uha.kr/room/"+q(uharoom)+'" method="post" target="uha_kr">        <input type="hidden" name="uhaname">        <input type="hidden" name="uhakey">      </form>    </div>',n=document.getElementById("UHACHATSCRIPT");n.parentNode.innerHTML=t+n.parentNode.innerHTML,uhaproto=="http://",uharoom=="test.uha.kr"&&(uhaserverurl["http://"]=["http://115.68.74.180:7000"]);var r=null,i=e("#uha_chat"),s=e("#uha_chat_input"),o=e("#uha_chat_msgs"),u=e("#uha_chat_users_count"),a=e("#uha_chat_btnclear"),f=e("#uha_chat_btnsettings"),l=e("#uha_chat_settings"),c=e("#uha_chat_admin"),h=e("#uha_chat_adminpw"),p=e("#uha_chat_adminstatus"),d=e("#uha_chat_adminmutelist"),v=e("#uha_chat_nickname"),m=e("#uha_chat_info"),g=e("#uha_chat_contextmenu"),y=e("#uha_chat_opacity"),b=e("#uha_chat_notifysound"),w=e("#uha_chat_notifytitle"),E=e("#uha_popup_form"),S=i.children("audio"),x=typeof document.createElement("audio").canPlayType=="function",T=null,N=!1,C=-9999999999999,k=2,L=!1,A=Math.floor(Math.random()*1024).toString(),O=window.uhacolorstyle||0,M=null,_=0,D="ã…ƒã…‰ã„¸ã„²ã…†ã…ã„´ã…‡ã„¹ã…‹ã…Œã…Šã…",P=(new Date).getTime()+1e4,H=document.title,B=0,j=0,F=/\b(?:https?):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,I=!1,X=window.uhaDateTime||function(e){var t=W(e);return t[3]+":"+t[4]},V=window.uhaDate||function(e){var t=W(e);return t[0]+"-"+t[1]+"-"+t[2]},et=function(){return Math.random().toString(36).substr(2)},tt=function(){return et()+et()+et()};if(typeof nt!="string")var nt=tt();o.append("<li>ëŒ€í™”ë°©ì— ë“¤ì–´ê°€ê³  ìˆìŠµë‹ˆë‹¤... ì´ ë§ì´ ì‚¬ë¼ì§€ì§€ ì•Šìœ¼ë©´ ì˜¤ë¥˜ê°€ ìƒê¸´ ê²ƒì…ë‹ˆë‹¤.</li>"),e.ajax({async:!0,url:uhaproto+"cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.2/socket.io.min.js",cache:!0,dataType:"script",success:function(){function t(n){var i=Math.floor(Math.random()*n.length);o.append('<li class="msgconnecting">'+i+"ë²ˆ ì„œë²„ë¡œ ë“¤ì–´ê°€ëŠ” ì¤‘...</li>"),window.WebSocket&&_<1?r=io.connect(n[i],{forceNew:!0,reconnection:!1,timeout:5e3,transports:["websocket"]}):r=io.connect(n[i],{forceNew:!0,reconnection:!1,timeout:5e3}),r.on("connect_error",function(e){_++,o.children().last().append("ì‹¤íŒ¨"),_>3&&(uhaproto="https://"),setTimeout(function(){t(uhaserverurl[uhaproto])},500)}),r.on("c",function(e){K(e,!1),k==2&&R(),b.prop("checked")&&x&&(S.prop("volume",1),S.eq(Math.floor(Math.random()*S.length)).trigger("play"));if(w.prop("checked")){var t=W(e.date);document.title=t[3]+":"+t[4]+":"+t[5]+" | "+H}}),r.on("i",function(t){e.each(t,function(e,t){o.append('<li class="uha_info"><span class="name">ì•ˆë‚´</span>'+t.msg+"</li>"),R()})}),r.on("connect",function(){_=0;if(typeof Storage!="undefined")try{if(localStorage.getItem("uhachatsid"))nt=localStorage.getItem("uhachatsid");else{var e=document.cookie.replace(/(?:(?:^|.*;\s*)PHPSESSID\s*\=\s*([^;]*).*$)|^.*$/,"$1");e&&(nt=e),localStorage.setItem("uhachatsid",nt)}!uhaname&&localStorage.getItem("uhachatname:"+uharoom)&&(uhaname=localStorage.getItem("uhachatname:"+uharoom)),localStorage.getItem("uhachatnotifysound:"+uharoom)=="1"&&b.prop("checked",!0),localStorage.getItem("uhachatnotifytitle:"+uharoom)=="1"&&w.prop("checked",!0)}catch(t){uhaname=""}r.emit("j",{sid:nt,name:uhaname,room:uharoom,host:window.location.host,key:uhakey}),T&&(U(550),r.emit("c",{msg:T}),T=null),o.children().last().append("ì„±ê³µ")}),r.on("n",function(e){u.text(e)}),r.on("w",function(){o.append("<li>ë„ë°°X ì¡°ê¸ˆ ê¸°ë‹¤ë¦¬ì„¸ìš”.</li>"),R()}),r.on("jd",function(e){nt=e.sid,r.emit("h",{last:"-9999999999999"}),U(1e3),o.children(".msgconnecting").remove()}),r.on("h",function(t){if(k==0){var r=o.children(":first");if(r.length)var s=r.offset().top-o.scrollTop()}e.each(t,function(e,t){K(t,!0)}),k==0&&r.length?o.scrollTop(r.offset().top-s):(n[i].indexOf("https://")>-1&&o.append('<li class="uha_info"><span class="name">ì•ˆë‚´</span>[SSL] ë³´ì•ˆ ì—°ê²°ë¡œ ë“¤ì–´ì˜¨ ëŒ€í™”ë°©ì…ë‹ˆë‹¤.</li>'),R()),U(10)}),r.on("l",function(e){e&&(C=e.toString())}),r.on("disconnect",function(){I=!1,h.show(),p.empty(),d.empty(),L?o.text("íšŒì› ì „ìš© í•´ëŒ€ì¸ ëŒ€í™”ë°©ì…ë‹ˆë‹¤. ë¹„íšŒì› ìƒíƒœì—ì„œëŠ” ëŒ€í™”ë°©ì— ë“¤ì–´ê°ˆ ìˆ˜ ì—†ì–´ìš”."):(o.html('<li class="msgconnecting">ëŠì–´ì§</li>'),setTimeout(function(){t(n)},100)),C=-9999999999999}),r.on("perm",function(){L=!0}),r.on("m",function(t){l.children("span").remove(),e.each(t,function(e,t){l.append("<span>"+q(t)+"</span>")})}),r.on("d",function(e){uhaname=e;if(typeof Storage!="undefined")try{localStorage.setItem("uhachatname:"+uharoom,e)}catch(t){}s.attr("placeholder","["+e+"]"+"ë¡œ ëŒ€í™”í•˜ê¸°"),s.data("mynick",e)}),r.on("ax",function(e){p.text("ì‹¤íŒ¨"),h.show()}),r.on("ao",function(e){p.text("ê´€ë¦¬ì ì¸ì¦ë¨"),I=!0,r.emit("al")}),r.on("al",function(t){d.empty(),e.each(t,function(e,t){d.append('<li data-name="'+t.name+'" data-until="'+t.until+'">['+t.name+"] "+Math.floor(t.until-(new Date).getTime()/1e3)+"ì´ˆ ë‚¨ìŒ<span>(x)</span></li>")})}),r.on("error",function(e){})}o.empty(),e("#uha_chat_form").submit(function(e){if(N){var t=s.val();e.preventDefault();if(t.length>0){if(!r.connected)T=t;else{var n=!1;(new Date).getTime()-1e4<P&&n?(o.append("<li>ë„ë°°X ì¡°ê¸ˆ ê¸°ë‹¤ë¦¬ì„¸ìš”.</li>"),R()):(s.data("to")?r.emit("c",{msg:t,to:s.data("to"),sid:s.data("tosid")}):r.emit("c",{msg:t}),D=t,P=(new Date).getTime()),U(550)}s.val("")}else s.attr("placeholder","["+s.data("mynick")+"]ë¡œ ëŒ€í™”í•˜ê¸°"),s.data("to",null),s.data("tosid",null);s.focus()}return!1}),l.dialog({title:"í•´ëŒ€ì¸ ì±„íŒ…ë°© ì„¤ì •",autoOpen:!1,beforeClose:function(e,t){clearTimeout(M)}}),c.dialog({title:"í•´ëŒ€ì¸ ì±„íŒ…ë°© ê´€ë¦¬ì",autoOpen:!1}),t(uhaserverurl[uhaproto])}}),a.on("click",function(){o.empty()}),f.on("click",function(){r.connected&&(!l.dialog("isOpen")&&!c.dialog("isOpen")?(l.children("span").remove(),l.dialog("open"),clearTimeout(M),M=setTimeout(function(){r.emit("m",null)},1e3),l.append("<span>ì‚¬ëŒë“¤ ì´ë¦„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>")):l.dialog("isOpen")&&!c.dialog("isOpen")?(l.dialog("close"),c.dialog("open"),I&&(clearTimeout(M),M=setTimeout(function(){r.emit("al")},400))):c.dialog("close"))}),v.on("keyup",function(e){e.keyCode==13&&(l.dialog("close"),clearTimeout(M),M=setTimeout(function(){r.emit("d",v.val()),v.val("")},1e3))}),h.on("keyup",function(e){if(e.keyCode==13){var t=h.val();clearTimeout(M),M=setTimeout(function(){r.emit("a",G(t))},1e3),h.val(""),h.hide(),p.text("ë¡œê·¸ì¸ ì¤‘...")}}),d.on("click","li > span",function(){N&&(r.emit("am",{name:e(this).parent().data("name"),until:e(this).parent().data("until"),duration:0}),clearTimeout(M),M=setTimeout(function(){r.emit("al")},400)),U(200)}),o.on("scroll",function(){r.connected&&o.scrollTop()==0?(r.emit("h",{last:C}),k=0):o.prop("scrollTop")>=o.prop("scrollHeight")-o.height()-40?k=2:k=1}),o.on("click","li > span.delete",function(){e(this).parent().remove()}),o.on("click","a",function(e){confirm("[ì£¼ì˜] ì•ˆì „í•œ ë§í¬ì¸ì§€ í™•ì¸í•˜ì„¸ìš”. í”¼ì‹±/íŒŒë°/ë°”ì´ëŸ¬ìŠ¤ë¥¼ ì¡°ì‹¬í•˜ì„¸ìš”. í•´ë‹¹ ì‚¬ì´íŠ¸ ê´€ë¦¬ìì—ê²Œ IP ì£¼ì†Œ, OS, ë¸Œë¼ìš°ì €, í˜„ì¬ ì‚¬ì´íŠ¸ì˜ ì£¼ì†Œ ë“±ì´ ë…¸ì¶œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")||e.preventDefault()}),o.on("mouseenter","li > span.name",function(t){if(e(t.target).data("date")){var n=W(e(t.target).data("date"));m.html(n[0]+"-"+n[1]+"-"+n[2]+" "+n[3]+":"+n[4]+":"+n[5]),m.show()}}),o.on("mouseout","li > span.name",function(e){m.hide(),m.css({top:0,left:0})}),o.on("mousemove","li > span.name",function(e){m.css({top:e.pageY-i.offset().top+10,left:e.offsetX+10})}),o.on("click","li > span.name",function(t){e(t.target).data("sid")&&(g.data(e(t.target).data()),g.html('<span id="uha_chat_targetname">'+q(g.data("name"))+'</span><br><span id="uha_chat_whisper">ê·“ì†ë§</span><br><div id="uha_chat_mute">ë²™ì–´ë¦¬</div><span id="uha_chat_contextmenu_close">ë‹«ê¸°</span>'),g.css({top:Math.min(t.pageY-i.offset().top+10,i.height()-15),left:t.offsetX+10}),I&&e("#uha_chat_mute").show(),g.show())}),g.on("click","#uha_chat_whisper",function(t){var n=e(t.target).parent().data();n&&n.sid&&n.sid!=nt?(s.attr("placeholder","["+n.name+"]ì—ê²Œ ê·“ì†ë§ ë³´ë‚´ê¸° (í•´ì œ : ë¹ˆë¬¸ì¥ ë³´ë‚´ê¸°)"),s.data("to",n.name),s.data("tosid",n.sid)):(s.attr("placeholder","["+s.data("mynick")+"]ë¡œ ëŒ€í™”í•˜ê¸°"),s.data("to",null),s.data("tosid",null)),g.hide(),s.focus()}),g.on("click","#uha_chat_invite",function(e){o.append('<li class="uha_info"><span class="name">ì•ˆë‚´</span>1:1 ëŒ€í™”ëŠ” ë¯¸ì™„ì„± ê¸°ëŠ¥ì…ë‹ˆë‹¤^^ -í•´ëŒ€ì¸</li>'),R()}),g.on("click","#uha_chat_mute",function(t){var n=e(t.target).parent().data();n&&n.sid&&n.sid!=nt&&(r.emit("am",{sid:n.sid,name:n.name,duration:600}),setTimeout(function(){r.emit("al")},600),g.hide())}),g.on("click","#uha_chat_contextmenu_close",function(e){g.hide()}),y.on("change",function(t){i.css({opacity:e(this).val()})}),e("#uha_chat_top_text > a").click(function(e){e.preventDefault(),E.find('input[name="uhaname"]').val(uhaname),E.find('input[name="uhakey"]').val(uhakey),E.submit()});if(document.domain=="uha.kr"||document.domain=="www.uha.kr")b.prop("checked",!0),w.prop("checked",!0);b.on("click",function(){try{b.prop("checked")?localStorage.setItem("uhachatnotifysound:"+uharoom,"1"):localStorage.setItem("uhachatnotifysound:"+uharoom,"0")}catch(e){}}),w.on("click",function(){try{w.prop("checked")?localStorage.setItem("uhachatnotifytitle:"+uharoom,"1"):localStorage.setItem("uhachatnotifytitle:"+uharoom,"0")}catch(e){}})})})(jQuery)}if(typeof uharoom!="string")var uharoom="uha.kr";if(typeof uhakey!="string")var uhakey="";if(typeof uhaname!="string")var uhaname="";if(typeof uhacss!="string")var uhacss="";if(typeof uhasid!="string")var uhasid="";var uhaserverurl=[];uhaserverurl["http://"]=["http://b.uha.kr:80","http://b.uha.kr:554","http://b.uha.kr:1755","http://b.uha.kr:8080"],uhaserverurl["https://"]=["https://b.uha.kr:443"];if(window.location.protocol.indexOf("https")>-1)var uhaproto="https://";else var uhaproto="http://";var uhaloadjss=function(){typeof window.JSON=="undefined"?uhaGetScript(uhaproto+"cdnjs.cloudflare.com/ajax/libs/json3/3.3.2/json3.min.js",function(){uhaloadjss()}):typeof window.jQuery=="undefined"?uhaGetScript(uhaproto+"cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js",function(){uhaloadjss()}):typeof window.jQuery.ui=="undefined"?uhaGetScript(uhaproto+"cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js",function(){init()}):init()};window.addEventListener?window.addEventListener("load",uhaloadjss,!1):window.attachEvent&&window.attachEvent("onload",uhaloadjss);
